Table of Contents

24.1 Testing Saves Money, Jobs, and Lives . . . . . . . . . . . . . . . . . . . 293
24.2 How to Structure Tests . . . . . . . . . . . . . . . . . . . . . . . . . . 294
24.3 How to Write Unit Tests . . . . . . . . . . . . . . . . . . . . . . . . . 295
24.3.1 Each Test Method Tests One Thing . . . . . . . . . . . . . . . 295
24.3.2 For Views, When Possible Use the Request Factory . . . . . . . 297
24.3.3 Don’t Write Tests That Have to Be Tested . . . . . . . . . . . . 299
24.3.4 Don’t Repeat Yourself Doesn’t Apply to Writing Tests . . . . . . 299
24.3.5 Don’t Rely on Fixtures . . . . . . . . . . . . . . . . . . . . . . 299
24.3.6 Things That Should Be Tested . . . . . . . . . . . . . . . . . . 300
24.3.7 Test for Failure . . . . . . . . . . . . . . . . . . . . . . . . . . 301
24.3.8 Use Mock to Keep Unit Tests From Touching the World . . . . 302
24.3.9 Use Fancier Assertion Methods . . . . . . . . . . . . . . . . . . 304
24.3.10 Document the Purpose of Each Test . . . . . . . . . . . . . . . 305
24.4 What About Integration Tests? . . . . . . . . . . . . . . . . . . . . . . 305
24.5 Continuous Integration . . . . . . . . . . . . . . . . . . . . . . . . . . 306
24.6 Who Cares? We Don’t Have Time for Tests! . . . . . . . . . . . . . . . 306
24.7 The Game of Test Coverage . . . . . . . . . . . . . . . . . . . . . . . . 307
24.8 Setting Up the Test Coverage Game . . . . . . . . . . . . . . . . . . . 307
24.8.1 Step 1: Start Writing Tests . . . . . . . . . . . . . . . . . . . . 307
24.8.2 Step 2: Run Tests and Generate Coverage Report . . . . . . . . 307
24.8.3 Step 3: Generate the Report! . . . . . . . . . . . . . . . . . . . 308
24.9 Playing the Game of Test Coverage . . . . . . . . . . . . . . . . . . . . 308
24.10 Alternatives to unittest . . . . . . . . . . . . . . . . . . . . . . . . . . 309
24.11 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310
